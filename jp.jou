

def main() -> int:
    # Valid JSON
    # TODO: test \r, \n, \f
    assert is_valid_json("{\"foo\":\"bar\"}")
    assert is_valid_json("123")
    assert is_valid_json("-42")
    assert is_valid_json("3.1415")
    assert is_valid_json("true")
    assert is_valid_json("false")
    assert is_valid_json("null")
    assert is_valid_json("\"hello\"")
    # TODO:
    #assert is_valid_json("\"escaped \\\"quote\\\" inside\"")
    assert is_valid_json("[]")
    assert is_valid_json("[1, 2, 3]")
    assert is_valid_json("[true, null, \"x\"]")
    assert is_valid_json("{}")
    assert is_valid_json("{\"a\":1,\"b\":2}")
    assert is_valid_json("{\"nested\":{\"x\":[1,2,3]}}")
    assert is_valid_json(" { \"nested\" : [1,2,3] }")
    assert is_valid_json("  {  \"spaced\"  :  [  1  ,  2  \t\r\n ,  3  ]  }  ")

    # Technically NaN and Infinity are not allowed, but they are widely used
    # extensions and e.g. Python supports them by default.
    assert is_valid_json("{\"a\": Infinity}")
    assert is_valid_json("{\"a\": -Infinity}")
    assert is_valid_json("{\"a\": NaN}")

    # Depth 64, barely allowed
    assert is_valid_json("[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]")

    # Invalid JSON
    assert not is_valid_json("")
    assert not is_valid_json(" ")
    assert not is_valid_json("{")
    assert not is_valid_json("}")
    assert not is_valid_json("[")
    assert not is_valid_json("]")
    assert not is_valid_json("[a]")
    assert not is_valid_json("[รถ]")
    assert not is_valid_json("[']")
    assert not is_valid_json("['hi']")
    assert not is_valid_json("[\"]")
    # Depth 65
    assert not is_valid_json("[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[[]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]")
    assert not is_valid_json("[]junk")
    assert not is_valid_json("{}junk")
    assert not is_valid_json("{foo: \"bar\"}")       # keys must be quoted
    assert not is_valid_json("{\"a\":}")             # missing value
    assert not is_valid_json("{\"a\":1,}")           # trailing comma
    assert not is_valid_json("[1,2,]")               # trailing comma
    assert not is_valid_json("[1 2]")                # missing comma
    assert not is_valid_json("\"unterminated string")
    assert not is_valid_json("tru")                  # invalid literal
    assert not is_valid_json("nulll")
    assert not is_valid_json("00")                   # invalid number format
    assert not is_valid_json("01")
    assert not is_valid_json("1.")                   # invalid number format
    assert not is_valid_json("{\"a\": infinity}")
    assert not is_valid_json("{\"a\": InfinityLol}")
    assert not is_valid_json("{\"a\": nan}")
    assert not is_valid_json("{\"a\": -NaN}")
    assert not is_valid_json("{\"a\": NaNa}")

    printf("ok\n")
    return 0
