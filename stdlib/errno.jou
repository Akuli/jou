# C's errno is actually a macro that expands to a function call.
# The function name varies by platform.
if WINDOWS:
    declare _errno() -> int*
elif LINUX:
    declare __errno_location() -> int*
elif MACOS:
    declare __error() -> int*
elif NETBSD:
    declare __errno() -> int*
else:
    assert False


@public
def set_errno(value: int) -> None:
    if WINDOWS:
        *_errno() = value
    elif LINUX:
        *__errno_location() = value
    elif MACOS:
        *__error() = value
    elif NETBSD:
        *__errno() = value
    else:
        assert False

@public
def get_errno() -> int:
    if WINDOWS:
        return *_errno()
    elif LINUX:
        return *__errno_location()
    elif MACOS:
        return *__error()
    elif NETBSD:
        return *__errno()
    else:
        assert False


# Convert an error code into a string. Do not modify or free() the returned string.
@public
declare strerror(errno_value: int) -> byte*
